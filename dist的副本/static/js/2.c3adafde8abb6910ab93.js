webpackJsonp([2],{"43jC":function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,'\n@charset "UTF-8";\n/* 图片库 */\n.photoGallery[data-v-c2b30f74] {\n  height: 350px;\n  margin-bottom: 15px;\n}\n.photoGallery-item[data-v-c2b30f74] {\n  display: inline-block;\n  position: relative;\n  width: 150px;\n  height: 150px;\n  background-position: center;\n  background-size: auto 100%;\n  margin: 0 15px 15px 0;\n  border-radius: 5px;\n  border: 5px solid #f7f5f5;\n}\n.photoGallery-operate[data-v-c2b30f74] {\n  position: absolute;\n  right: 8px;\n  top: 5px;\n  width: 15px;\n  overflow: hidden;\n}\n.photoGallery-operate i[data-v-c2b30f74] {\n  color: #39f778;\n}\n.photobotton[data-v-c2b30f74] {\n  display: inline-block;\n}\n.nodata[data-v-c2b30f74] {\n  text-align: center;\n  min-height: 80px;\n}\n',""])},"8YH0":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("7Otq"),s=a.n(o),i=a("PmpH"),n=a("Prlc"),c=a("Xv2c"),r=a("qsHl"),l=a("u2ya"),p=a("pXKa"),u=a("E4LH"),d={name:"shopAdd",components:{CityCascader:i.a,PhotoAlbum:n.a},data:function(){var t=function(t,e,a){e?Object(u.a)(e)?a():a(null):a()};return{logo:s.a,loading:!1,companyStatus:!1,cname:this.$route.query.name,shopForm:{companyId:"",shopname:"",shopType:"",introdcution:"",provinceId:"",cityId:"",districtId:"",address:"",subways:[],shoplogoUrl:"",goodsType:[{pcat:"",cat:"",rate:""}],phone1:"",phone2:""},pcatFirstValue:"",shopTypeList:[{id:1,name:"直营店"},{id:2,name:"加盟店"}],categoryData:{firstList:[],secondList:[]},subwayList:[],companysList:[],businessCircle:[],isPhotosDialog:!1,isCloseStatus:!1,picList:[],companyRules:{companyId:[{required:!0,message:"请选择企业",trigger:"change"}],shopname:[{required:!0,message:"请输入门店名称",trigger:"blur"}],shopType:[{required:!0,message:"请选择门店分类",trigger:"change"}],phone1:[{validator:t,message:"联系电话格式不正确",trigger:"blur"}],phone2:[{validator:t,message:"联系电话格式不正确",trigger:"blur"}]}}},computed:{cid:function(){return this.$route.query.id?this.$route.query.id:""}},mounted:function(){this.getGoodsCategory(),this.$route.query.id?(this.companyStatus=!0,this.shopForm.companyId=this.$route.query.id):(this.companyStatus=!1,this.getCompanysList())},methods:{onSave:function(){var t=this;this.$refs.shopForm.validate(function(e){if(!e)return console.log("error submit!!"),!1;t.loading=!0,Object(l.a)(t.shopForm).then(function(e){t.$message({type:"success",message:"保存成功!"}),t.loading=!1,t.companyStatus?t.$router.push({name:"companyManage"}):t.$router.push({name:"shopManage"})}).catch(function(){t.loading=!1})})},getCompanysList:function(){var t=this;Object(l.c)().then(function(e){e.data?t.companysList=e.data:t.companysList=[]})},addCategory:function(){this.shopForm.goodsType.push({pcat:"",cat:"",rate:""})},deleteCategory:function(t){this.shopForm.goodsType.splice(t,1)},getGoodsCategory:function(t){var e=this;Object(r.e)(t).then(function(a){t?e.categoryData.secondList=a.data:e.categoryData.firstList=a.data})},pcatChange:function(t,e){this.getGoodsCategory(t),this.shopForm.goodsType[e].pcat=t,this.shopForm.goodsType[e].cat=""},catChange:function(t,e){this.shopForm.goodsType[e].cat=t},openPhotos:function(t){this.isPhotosDialog=!0,this.getPicList()},selectImg:function(t){this.isPhotosDialog=!1,this.shopForm.shoplogoUrl=t},updateData:function(t){t&&this.getPicList()},getPicList:function(){var t=this;this.listLoading=!0,Object(p.f)().then(function(e){var a=e.data;t.picList=a.reverse(),t.listLoading=!1})},getSubwayList:function(t){var e=this;Object(c.b)(t).then(function(t){e.subwayList=t.data})},disabledHandle:function(t){if(this.shopForm.subways.length>=5)return this.shopForm.subways.indexOf(t)<0},subwaysChange:function(t){this.shopForm.subways=t},selectData:function(t){t.firstValue&&(this.shopForm.provinceId=t.firstValue),t.secondValue&&(this.getSubwayList(t.secondValue),this.shopForm.cityId=t.secondValue),t.thirdValue&&(this.shopForm.districtId=t.thirdValue)},clearData:function(t){1===t?(this.shopForm.cityId="",this.shopForm.districtId="",this.subwayList=[]):2===t&&(this.shopForm.districtId="")}}},h={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"third-header"},[a("router-link",{attrs:{to:{name:"shopManage"}}},[a("span",{staticClass:"backPrev"},[a("svg-icon",{attrs:{"icon-class":"back"}})],1)]),t._v(" "),a("span",[t._v("新建门店")])],1),t._v(" "),a("el-form",{ref:"shopForm",staticClass:"shopForm",attrs:{rules:t.companyRules,model:t.shopForm,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"所属企业",prop:"companyId"}},[t.companyStatus?a("span",[t._v(t._s(t.cname))]):a("el-select",{attrs:{placeholder:"请选择企业"},model:{value:t.shopForm.companyId,callback:function(e){t.$set(t.shopForm,"companyId",e)},expression:"shopForm.companyId"}},t._l(t.companysList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"门店名称",prop:"shopname"}},[a("el-input",{attrs:{placeholder:"请输入门店名称"},model:{value:t.shopForm.shopname,callback:function(e){t.$set(t.shopForm,"shopname","string"==typeof e?e.trim():e)},expression:"shopForm.shopname"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"门店分类",prop:"shopType"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.shopForm.shopType,callback:function(e){t.$set(t.shopForm,"shopType",e)},expression:"shopForm.shopType"}},t._l(t.shopTypeList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"门店介绍"}},[a("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入门店介绍"},model:{value:t.shopForm.introdcution,callback:function(e){t.$set(t.shopForm,"introdcution",e)},expression:"shopForm.introdcution"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"门店地址"}},[a("ul",[a("li",[a("city-cascader",{on:{selectData:t.selectData,clearData:t.clearData}})],1),t._v(" "),a("li",{staticStyle:{"margin-top":"15px"}},[a("el-input",{staticClass:"cityInput",attrs:{placeholder:"请输入详细地址"},model:{value:t.shopForm.address,callback:function(e){t.$set(t.shopForm,"address","string"==typeof e?e.trim():e)},expression:"shopForm.address"}})],1),t._v(" "),t.subwayList.length>0?a("li",[a("div",{staticClass:"inlint checkboxTitle"},[a("span",[t._v("周边地铁：")]),t._v(" "),a("p",[t._v("已选中\n              "),a("span",[t._v(t._s(t.shopForm.subways.length))]),t._v("个")])]),t._v(" "),a("div",{staticClass:"inlint"},[a("el-checkbox-group",{staticClass:"checkboxGroup",attrs:{max:5},on:{change:t.subwaysChange},model:{value:t.shopForm.subways,callback:function(e){t.$set(t.shopForm,"subways",e)},expression:"shopForm.subways"}},t._l(t.subwayList,function(e){return a("el-checkbox",{key:e.id,attrs:{disabled:t.disabledHandle(e.id),label:e.id}},[t._v("\n                "+t._s(e.name)+"\n              ")])}))],1)]):t._e(),t._v(" "),t.businessCircle.length>0?a("li",[a("div",{staticClass:"inlint"},[a("p",[t._v("周边商圈：")]),t._v(" "),a("p",[t._v("已选中\n              "),a("span",[t._v("1")]),t._v("个")])]),t._v(" "),a("div",{staticClass:"inlint"})]):t._e()])]),t._v(" "),a("el-form-item",{attrs:{label:"门店图标"}},[a("div",{staticClass:"inlint shoplogo"},[t.shopForm.shoplogoUrl?a("img",{attrs:{src:t.shopForm.shoplogoUrl,alt:""}}):a("img",{attrs:{src:t.logo,alt:""}})]),t._v(" "),a("div",{staticClass:"inlint"},[a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:t.openPhotos}},[t._v("选择")])],1)]),t._v(" "),a("el-form-item",{attrs:{label:"可用商品类目",required:""}},t._l(t.shopForm.goodsType,function(e,o){return a("div",{key:o},[a("el-row",[a("el-col",{attrs:{span:16}},[a("el-form-item",{staticStyle:{"margin-bottom":"25px"},attrs:{prop:"goodsType."+o+".pcat",rules:[{required:!0,message:"一级类目不能为空",trigger:"change"}]}},[a("el-select",{attrs:{placeholder:"一级类目"},on:{change:function(a){t.pcatChange(e.pcat,o)}},model:{value:e.pcat,callback:function(a){t.$set(e,"pcat",a)},expression:"domain.pcat"}},t._l(t.categoryData.firstList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),t._v(" "),a("el-select",{attrs:{placeholder:"全部"},on:{change:function(a){t.catChange(e.cat,o)}},model:{value:e.cat,callback:function(a){t.$set(e,"cat",a)},expression:"domain.cat"}},t._l(t.categoryData.secondList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{staticStyle:{"margin-bottom":"25px"},attrs:{prop:"goodsType."+o+".rate",rules:[{required:!0,message:"佣金不能为空",trigger:"blur"},{type:"number",min:0,max:100,message:"佣金必须为0-100之间的数字",trigger:"blur"}]}},[a("el-input",{staticClass:"commission",attrs:{placeholder:"请输入佣金"},model:{value:e.rate,callback:function(a){t.$set(e,"rate",t._n(a))},expression:"domain.rate"}}),t._v(" "),a("span",[t._v("%")]),t._v(" "),0==o?a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:t.addCategory}},[t._v("添加")]):a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(e){t.deleteCategory(o)}}},[t._v("删除")])],1)],1)],1)],1)})),t._v(" "),a("el-form-item",{attrs:{label:"联系电话1",prop:"phone1"}},[a("el-input",{attrs:{placeholder:"请输入联系电话"},model:{value:t.shopForm.phone1,callback:function(e){t.$set(t.shopForm,"phone1","string"==typeof e?e.trim():e)},expression:"shopForm.phone1"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"联系电话2",prop:"phone2"}},[a("el-input",{attrs:{placeholder:"请输入联系电话"},model:{value:t.shopForm.phone2,callback:function(e){t.$set(t.shopForm,"phone2","string"==typeof e?e.trim():e)},expression:"shopForm.phone2"}})],1),t._v(" "),a("el-form-item",[a("el-button",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{type:"primary"},on:{click:t.onSave}},[t._v("保存")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"图片库",visible:t.isPhotosDialog},on:{"update:visible":function(e){t.isPhotosDialog=e},close:function(e){t.isCloseStatus=!0},open:function(e){t.isCloseStatus=!1}}},[a("photo-album",{attrs:{photoType:"shop",photoList:t.picList,closeDialog:t.isCloseStatus},on:{selectImg:t.selectImg,updatedata:t.updateData}})],1)],1)},staticRenderFns:[]};var m=a("VU/8")(d,h,!1,function(t){a("YE8z")},"data-v-a5f7b7fc",null);e.default=m.exports},Prlc:function(t,e,a){"use strict";var o=a("pXKa"),s=a("xuzd"),i={props:["photoType","photoList","closeDialog"],watch:{closeDialog:function(t){t&&(this.checkedImg=[],this.isIndex=-1,this.isDeleteStatus=!1)}},data:function(){return{listLoading:!1,fileList:[],checkedImg:[],isDeleteStatus:!1,isIndex:-1,selectImgUrl:"",loading:!1}},methods:{submitPhoto:function(){this.$emit("selectImg",this.selectImgUrl)},selectPhoto:function(t,e){this.isIndex=e,this.selectImgUrl=t.imageUrl},Upload:function(t){var e=this,a="";"banner"===this.photoType?a="banner"+t.file.uid:"icon"===this.photoType?a="icon"+t.file.uid:"shop"===this.photoType&&(a="shop"+t.file.uid),this.loading=!0,this.listLoading=!0,Object(s.a)().put(a,t.file).then(function(t){e.fileList[0]={name:t.name,url:t.url},"banner"===e.photoType?Object(o.g)(e.fileList).then(function(t){e.$emit("updatedata",!0)}):"icon"===e.photoType?Object(o.h)(e.fileList).then(function(t){e.$emit("updatedata",!0)}):"shop"===e.photoType&&Object(o.i)(e.fileList).then(function(t){e.$emit("updatedata",!0)}),e.loading=!1,e.listLoading=!1}).catch(function(t){console.log(t),e.loading=!1,e.listLoading=!1})},DeletePhoto:function(){var t=this,e=[];this.checkedImg.length>0?(this.checkedImg.forEach(function(t){e.push({url:t})}),"banner"===this.photoType?Object(o.a)(e).then(function(e){t.$message({type:"success",message:"删除成功!"}),t.checkedImg=[],t.$emit("updatedata",!0)}):"icon"===this.photoType?Object(o.b)(e).then(function(e){t.$message({type:"success",message:"删除成功!"}),t.checkedImg=[],t.$emit("updatedata",!0)}):"shop"===this.photoType&&Object(o.c)(e).then(function(e){t.$message({type:"success",message:"删除成功!"}),t.checkedImg=[],t.$emit("updatedata",!0)})):this.$message({type:"warning",message:"您未选择要删除的图片!"})},handleChange:function(t){this.checkedImg=t}}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading.body",value:t.listLoading,expression:"listLoading",modifiers:{body:!0}}]},[t.photoList.length<=0?a("div",{staticClass:"nodata"},[t._v("\n    暂无图片\n  ")]):a("div",{staticClass:"photoGallery"},[a("el-scrollbar",{staticStyle:{height:"100%"}},t._l(t.photoList,function(e,o){return a("div",{key:o,staticClass:"photoGallery-item",style:"background-image: url("+e.imageUrl+")",on:{click:function(a){t.selectPhoto(e,o)}}},[a("div",{staticClass:"photoGallery-operate"},[t.isDeleteStatus||o!=t.isIndex?t._e():a("i",{staticClass:"el-icon-success"}),t._v(" "),t.isDeleteStatus?a("el-checkbox-group",{on:{change:t.handleChange},model:{value:t.checkedImg,callback:function(e){t.checkedImg=e},expression:"checkedImg"}},[a("el-checkbox",{attrs:{label:e.imageUrl}})],1):t._e()],1)])}))],1),t._v(" "),a("div",{staticClass:"photobotton"},[t.isDeleteStatus?t._e():a("div",[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){t.isDeleteStatus=!0}}},[t._v("删除")]),t._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.submitPhoto}},[t._v("确定")])],1),t._v(" "),t.isDeleteStatus?a("div",[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.DeletePhoto}},[t._v("批量删除")]),t._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){t.isDeleteStatus=!1}}},[t._v("取消")])],1):t._e()]),t._v(" "),a("div",{staticClass:"photobotton",staticStyle:{float:"right"}},[a("el-upload",{attrs:{"http-request":t.Upload,multiple:!0,"show-file-list":!1,action:""}},[a("el-button",{attrs:{size:"small",type:"primary",loading:t.loading}},[t._v("点击上传")])],1)],1)])},staticRenderFns:[]};var c=a("VU/8")(i,n,!1,function(t){a("lQ3k")},"data-v-c2b30f74",null);e.a=c.exports},YE8z:function(t,e,a){var o=a("yfZ2");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);a("rjj0")("ecbb877e",o,!0)},lQ3k:function(t,e,a){var o=a("43jC");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);a("rjj0")("2faf492c",o,!0)},pXKa:function(t,e,a){"use strict";e.d=function(){return Object(o.a)({url:"app/banner/picload",method:"POST",data:{token:Object(s.a)()}})},e.g=function(t){return Object(o.a)({url:"app/banner/picupload",method:"POST",data:{token:Object(s.a)(),picList:t}})},e.a=function(t){return Object(o.a)({url:"app/banner/picdelete",method:"POST",data:{token:Object(s.a)(),picList:t}})},e.e=function(){return Object(o.a)({url:"app/palace/picload",method:"POST",data:{token:Object(s.a)()}})},e.h=function(t){return Object(o.a)({url:"app/palace/picupload",method:"POST",data:{token:Object(s.a)(),picList:t}})},e.b=function(t){return Object(o.a)({url:"app/palace/picdelete",method:"POST",data:{token:Object(s.a)(),picList:t}})},e.f=function(){return Object(o.a)({url:"base/picload",method:"POST",data:{token:Object(s.a)(),type:6}})},e.i=function(t){return Object(o.a)({url:"base/picupload",method:"POST",data:{token:Object(s.a)(),type:6,picList:t}})},e.c=function(t){return Object(o.a)({url:"base/picdelete",method:"POST",data:{token:Object(s.a)(),picList:t}})};var o=a("vLgD"),s=a("TIfe")},qsHl:function(t,e,a){"use strict";e.e=function(t){return Object(s.a)({url:"goods/cat/list",method:"POST",data:{token:Object(i.a)(),pid:t}})},e.f=function(t){return Object(s.a)({url:"shopcat/list",method:"POST",data:{token:Object(i.a)(),curPage:t.curPage,pageSize:t.pageSize}})},e.a=function(t){return Object(s.a)({url:"shopcat/update",method:"POST",data:{token:Object(i.a)(),pcat:t.pcat,cat:t.cat,catName:t.catName,shopIds:t.shopIds}})},e.b=function(t){return Object(s.a)({url:"goods/cat/add",method:"POST",data:{token:Object(i.a)(),name:t}})},e.c=function(t){return Object(s.a)({url:"shopcat/add",method:"POST",data:{token:Object(i.a)(),pcat:t.pcat,cat:t.cat,catName:t.catName,shopIds:t.shopIds}})},e.d=function(t,e){return Object(s.a)({url:"shopcat/delete",method:"POST",data:{token:Object(i.a)(),pcat:t,cat:e}})},e.g=function(t){var e={token:Object(i.a)()};for(var a in t)""!==t[a]&&o.default.set(e,a,t[a]);return Object(s.a)({url:"shopcat/validshops",method:"POST",data:e})};var o=a("7+uW"),s=a("vLgD"),i=a("TIfe")},yfZ2:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,"\n.shopForm[data-v-a5f7b7fc] {\n  width: 750px;\n}\n.shopForm .cityInput[data-v-a5f7b7fc] {\n    width: 613px;\n    margin-bottom: 10px;\n}\n.shopForm .checkboxTitle[data-v-a5f7b7fc] {\n    vertical-align: top;\n}\n.shopForm .checkboxGroup[data-v-a5f7b7fc] {\n    width: 520px;\n    text-align: left;\n}\n.shopForm .checkboxGroup .el-checkbox[data-v-a5f7b7fc] {\n      margin-left: 20px;\n}\n.shoplogo[data-v-a5f7b7fc] {\n  width: 150px;\n  height: 150px;\n  vertical-align: bottom;\n}\n.commission[data-v-a5f7b7fc] {\n  width: 100px;\n}\n",""])}});